<!doctype html><html lang=vi translate=no><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Phân loại sinh học</title><link rel=icon href=./icon.png><link rel=preconnect href=https://en.wikipedia.org><link rel=preconnect href=https://vi.wikipedia.org><link rel=dns-prefetch href=https://cdn.jsdelivr.net><script src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js></script><script src=https://cdn.jsdelivr.net/npm/mithril@2.2.2/mithril.min.js></script><style>@font-face{font-family:DejaVuSansMono;src:url("https://cdn.jsdelivr.net/gh/tientq64/fonts/DejaVuSansMono.woff2")}*,:after,:before{box-sizing:border-box}html{--sans:sans-serif;--lineH:19px}body{margin:0;font-family:var(--sans);font-size:16px;overflow:hidden;background:#282a39;color:#fff;color-scheme:dark;user-select:none;cursor:default}.loading{position:absolute;left:0;top:0;width:100vw;height:100vh;display:flex;flex-direction:column;gap:16px;justify-content:center;align-items:center}.line{height:var(--lineH)}.lineFind>.node>.name{outline:2px solid #f9d87d}.node{padding-left:6px;padding-right:6px;border-radius:4px;display:inline-flex;align-items:baseline;font-family:var(--sans);font-size:16px;vertical-align:middle}.name{cursor:pointer}.dash,.textEn,.textVi{margin-left:6px;font-family:var(--sans);color:#648185}.dash{margin-left:8px}.textEnCopy{display:inline-block;gap:6px;text-decoration:underline;text-decoration-skip-ink:none;cursor:copy}.textEnCopy:not(:first-child){margin-left:6px}.textEnCopyIsDuplicateTextEn{color:#ab5b78}.textEn{font-size:16px}.textVi{font-size:16px;color:#a39f83}.textEn+.textVi:before{content:"\b7";margin-right:6px}.img{min-width:6px;min-height:6px;max-width:16px;max-height:16px;margin-left:8px;padding:1px;background:#fff;cursor:pointer}.img+.img{margin-left:4px}.life{color:#3b82f6}.domain{color:#3b82f6}.kingdom{color:#3b82f6}.phylum{color:#ff1267}.class{color:#ff8e08}.order{color:#2cb3e6}.family{color:#6ae22e}.tribe{color:#a370ff}.genus{color:#fc6}.species{color:#fff}.subspecies{color:#fff}#scrollEl{position:absolute;left:0;top:0;width:100%;height:100%;overflow-x:hidden;overflow-y:auto}#heightEl{width:1px;display:inline-block;pointer-events:none}#presEl{height:100%;margin:0;padding-left:64px;font-family:DejaVuSansMono,monospace;font-size:16px;white-space:pre;tab-size:2}#infosEl{position:absolute;right:16px;bottom:0;padding:16px;border-radius:8px 4px 4px 4px;display:grid;grid-template-columns:repeat(3,auto);gap:4px 16px;background:#fff;color:#000}.modfCountIncr{color:#16a34a}.modfCountDecr{color:#db2777}.lang{position:absolute;right:22px;bottom:6px;width:30px;padding:6px;border-radius:6px 4px 4px 4px;text-align:center;background:#2cb3e6;color:#0c4a6e;cursor:pointer}.langIsVi{background:#f472b6;color:#831843}#findEl{position:absolute;top:0;right:16px;width:300px;padding:6px;border-radius:4px 4px 4px 8px;display:flex;align-items:center;background:#fff;color:#000}#findInputEl{width:0;height:24px;padding:0 8px;border:0;flex-grow:1;font:inherit;background:inherit;color:inherit;outline:0}.findButton{width:28px;margin-left:4px;border-radius:4px;display:flex;justify-content:center;align-items:center;align-self:stretch;font-family:DejaVuSansMono,monospace;font-size:16px;cursor:pointer}.findButton:hover{background:rgba(0,119,221,.2)}.findButtonOn{color:#07d}#findClose{font-weight:700;color:#e43}#findClose:hover{background:rgba(238,68,51,.2)}#findTextEl{margin:0 8px 0;font-size:14px;color:#888}#popupEl{max-width:min-content;border-radius:8px;font-size:16px;text-align:center;overflow:hidden;color:#000;box-shadow:1px 2px 4px 1px rgba(0,0,0,.533);pointer-events:none}.popupBody{width:328px;padding:8px 4px;border-radius:8px;display:flex;flex-direction:column;background:#f1f5f9;animation:popup 50ms forwards}.popupIsTrinomial .popupName{font-size:15px}.popupIsTwoImage{width:652px}.popupName{position:relative;padding:2px 8px 4px;display:flex;justify-content:center;align-items:center;font-size:16px;font-weight:700;white-space:nowrap}.popupIcon{position:absolute;left:8px;height:24px}.popupRank{position:absolute;right:8px;color:#648185;font-size:11px}.popupTextEn,.popupTextVi{padding:0 8px 1px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;color:#333}.popupGenders{margin-top:6px;display:flex;justify-content:center;column-gap:4px}.popupGender{width:100%;display:flex;flex-direction:column;align-self:stretch}.popupPicture{position:relative;width:320px;border-radius:6px;display:flex;justify-content:center;align-items:center;flex-grow:1;overflow:hidden}.popupPicture:after{content:"";position:absolute;inset:0;border-radius:6px;box-shadow:inset 0 0 16px 1px rgba(0,0,0,.2);pointer-events:none}.popupBgImg{position:absolute;left:0;top:0;width:100%;height:100%;display:block;object-fit:cover;filter:blur(24px) saturate(2)}.popupImg{max-width:320px;max-height:240px;display:block;background:#fff;filter:contrast(1.1) saturate(1.1);image-rendering:-webkit-optimize-contrast;z-index:0}.popupImg--cover{width:100%;height:100%;object-fit:cover}.popupGenderCaptn{margin-top:2px;margin-bottom:-1px;padding:0 8px;font-size:14px;color:#333}.popupSummary{padding:0 8px;line-height:1.35}.popupSummary:not(:empty){margin-top:6px}.popupSummary>p{margin:0;text-align:justify!important}.popupSummary a{text-decoration:none;color:inherit}@-moz-keyframes popup{from{transform:scale(.96)}to{transform:scale(1)}}@-webkit-keyframes popup{from{transform:scale(.96)}to{transform:scale(1)}}@-o-keyframes popup{from{transform:scale(.96)}to{transform:scale(1)}}@keyframes popup{from{transform:scale(.96)}to{transform:scale(1)}}</style><div class=loading><img src=./icon.png height=24> Đang tải</div><script>!async function(){var e,t,i,n,s,o,a,l,r,c,h,p,u,d,g,f,b,w,v,x;for(d in null==(e=localStorage).taxonFindExact&&(e.taxonFindExact=""),null==e.taxonFindCase&&(e.taxonFindCase="1"),null==e.taxonInfoLv&&(e.taxonInfoLv="0"),null==e.taxonRightClickAction&&(e.taxonRightClickAction="k"),null==e.taxonPopupLang&&(e.taxonPopupLang="en"),null==e.taxonTheme&&(e.taxonTheme="default"),document.documentElement.classList.add(localStorage.taxonTheme),t=getComputedStyle(document.documentElement),i=parseInt(t.getPropertyValue("--lineH")),n=[],s={},o=[["life",0,1],["domain",1,2],["kingdom",2,5],["phylum",5,10],["class",10,16],["order",16,24],["family",24,29],["tribe",29,32],["genus",32,38],["species",38,40],["subspecies",40,43]],a=[["",""],["Domain","Vực"],["Kingdom","Giới"],["Subkingdom","Phân giới"],["Infrakingdom","Thứ giới"],["Superphylum","Liên ngành"],["Phylum","Ngành"],["Subphylum","Phân ngành"],["Infraphylum","Thứ ngành"],["Parvphylum","Tiểu ngành"],["Superclass","Liên lớp"],["Class","Lớp"],["Subclass","Phân lớp"],["Infraclass","Thứ lớp"],["Parvclass","Tiểu lớp"],["Legion","Đoàn"],["Supercohort","Liên đội"],["Cohort","Đội"],["Megaorder","Tổng bộ"],["Superorder","Liên bộ"],["Order","Bộ"],["Suborder","Phân bộ"],["Infraorder","Thứ bộ"],["Parvorder","Tiểu bộ"],["Section","Đoạn"],["Subsection","Phân đoạn"],["Superfamily","Liên họ"],["Family","Họ"],["Subfamily","Phân họ"],["Supertribe","Liên tông"],["Tribe","Tông"],["Subtribe","Phân tông"],["Genus","Chi"],["Subgenus","Phân chi"],["Section","Mục"],["Subsection","Phân mục"],["Series","Loạt"],["Subseries","Phân loạt"],["Superspecies","Liên loài"],["Species","Loài"],[["Subspecies","Subsp."],["Phân loài","Ph.loài"]],[["Variety","Var."],"Thứ"],["Form","Dạng"]],l="localhost"===(r=location.hostname)||"127.0.0.1"===r,c=new Intl.NumberFormat("en"),h=void 0,2,p=+localStorage.taxonInfoLv,u={taxon:{label:"Tổng số mục",lv:1},family:{label:"Tổng số họ"},genus:{label:"Tổng số chi"},species:{label:"Tổng số loài",lv:1},speciesSubsp:{label:"Tổng số phân loài hoặc loài",lv:1},speciesSubspExists:{label:"Phân loài hoặc loài còn tồn tại"},speciesSubspExtinct:{label:"Phân loài hoặc loài tuyệt chủng"},speciesSubspHasViName:{label:"Phân loài và loài có tên tiếng Việt"},speciesSubspHasImg:{label:"Phân loài hoặc loài có hình ảnh",lv:1},img:{label:"Tổng số hình ảnh",lv:1}})null==(g=u[d]).lv&&(g.lv=2);f=async function(){var e,t,i,a,l,r,c,p,d,m,g,f,b,w,v,x,y,k,E,C,L,S,T,N,P,I,K,F,V,D,A,j,_,G,H,M,W,q,z=e=>{if("\\"!==e)return e},B=e=>{var t,i,n,s,o,a,l,r;if(i=(t=e.split(" ; "))[0],n=t[1],"?"!==i){switch("."===n&&(n=void 0),s=i[0],i=i.substring(1),s){case"-":i="https://i.imgur.com/"+i+"m.png";break;case"/":"/"===i[0]?(o="en",i=i.substring(1)):o="commons",a=i.split(".").at(-1),i="https://upload.wikimedia.org/wikipedia/"+o+"/thumb/"+i[0]+"/"+i+"/320px-"+i[0]+"."+a;break;case":":l=(t=c.exec(i))[1],i=t[2],a=t[3],i="https://"+(l=l?"inaturalist-open-data.s3.amazonaws.com":"static.inaturalist.org")+"/photos/"+i+"/medium."+(a=p[a]);break;case"@":i="https://live.staticflickr.com/"+i+"_e.jpg";break;case"%":i="https://www.biolib.cz/IMG/GAL/"+i+".jpg";break;case"~":i=(t=d.exec(i))[1],o=t[2],i="https://bugguide.net/images/"+(o=m[o])+"/"+i.substring(0,3)+"/"+i.substring(3,6)+"/"+i+".jpg";break;case"^":"^"===i[0]?(r="tools/uploadphoto/uploads",i=i.substring(1)):r="images/species",i="https://d1iraxgbwuhpbw.cloudfront.net/"+r+"/"+i+".jpg";break;case"+":i="https://cdn.download.ams.birds.cornell.edu/api/v1/asset/"+i+"1/320";break;case"$":i="https://reptile-database.reptarium.cz/content/photo_"+i+".jpg";break;case"<":i="https://www.fishwisepro.com/pics/JPG/"+i+".jpg";break;case">":t=i.split("/"),i="https://biogeodb.stri.si.edu/"+t[0]+"/resources/img/images/species/"+(i=t[1])+".jpg";break;case"=":i="https://cdn.jsdelivr.net/gh/tientq64/taimg/"+i+".webp";break;case"!":i="https://i.pinimg.com/564x/"+i+".jpg";break;case"&":i="https://images.marinespecies.org/thumbs/"+i+".jpg?w=320";break;default:i="h"+i}return[i,n]}},R=e=>e[0]>=S,$=e=>e[0]<S;for(b in e=(e=await(await fetch("tree.taxon")).text()).split("\n"),i=[t=[0,"Life",!1,[void 0,"/Sự_sống"],[],"Life","Sự sống"]],a=/^(\t*)(.+?)(\*)?(?: ([\\/].*?))?(?: \|([-a-z]+?))?(?: (!))?$/,l=/^([-/:@%~^+$<>=!&?]|https?:\/\/)/,r=/(?=[\\/])/,c=/^(:?)(\d+)([epJEPu]?)$/,p={"":"jpg",e:"jpeg",p:"png",J:"JPG",E:"JPEG",P:"PNG",u:""},d=/^([A-Z\d]+)([r]?)$/,m={"":"cache",r:"raw"},n=[],s={},g=0,f=-1,w=u)w[b].count=0;for(b=0,v=e.length;b<v;++b)x=void 0,y=void 0,k=void 0,E=(w=e[b].split(" # "))[0],C=w[1],L=w[2],w=a.exec(E),S=w[1],T=w[2],N=w[3],P=w[4],I=w[5],K=w[6],S=S.length+1,"_"===T&&(T=" "),P&&(P=P.split(r).map(z)),C&&(l.test(C)&&(L=C,C=void 0),C&&(y=(w=C.split(/\ ?\| /))[0],k=w[1]),L&&(x=L.split(" | ").map(B))),F=[S,T],N&&(F[2]=!0),P&&(F[3]=P),y&&(F[5]=y),k&&(F[6]=k),x&&(F[7]=x),I&&(F[8]=I),K&&(F[9]=!0),i.some(R)&&(i=i.filter($)),((V=i[i.length-1])[4]||(V[4]=[])).push(F),i.push(F);for(D=(e,t,i,o,a,l,r,c,p)=>{var d,m,b,w,v,x,y,k,E,C,L,S,T,N,P,I,K,F,V,A;if(d=e[0],m=e[1],b=e[2],w=e[3],v=e[4],x=e[5],y=e[6],k=e[7],E=e[8],C=e[9],b&&(a=!0),i>=0?(L=d-i-1,S=a?(l+(r&&"╸╸".repeat(L)+"╸┓"||"  ".repeat(L)+" ╏")).replace(/\ (?=[╸━┓])/,"╹").replace(/┃(?=[━┓])/,"┣"):(l+(r&&"━━".repeat(L)+"━┓"||"  ".repeat(L)+" ┃")).replace(/\ (?=[╸━┓])/,"┗").replace(/[┃╏](?=[━┓])/,"┣")):S=" ┃",S=null!=s[S]?s[S]:s[S]=g++,d>=39?(T=41===d?o+" var. "+m:o+" "+m,39===d&&u.species.count++,x&&u.speciesSubspHasViName.count++,v||(u.speciesSubsp.count++,k&&u.speciesSubspHasImg.count++,a&&u.speciesSubspExtinct.count++)):32===d?u.genus.count++:27===d&&u.family.count++,N={index:++f,lv:d,name:m,chrs:S},x&&(N.textEn=x),y&&(N.textVi=y),h&&h<39&&v&&v[0][0]>h&&(N.isShowChildsCount=!0),k&&(N.imgs=k,u.img.count+=k.length),a&&(N.extinct=a),w&&(N.disam=w),T&&(N.fullName=T),E&&(N.icon=E),C&&(N.isDuplicateTextEn=C),t&&(N.parent=t),n.push(N),v)for(N.childsCount=v.length,l+="  ".repeat(L)+(c?"  ":a||p?" ╏":" ┃"),(d<34||d>38)&&("?"!==m&&" "!==m?o=33===d?o+" ("+m+")":T||m:32===d&&(o='"'+o+'"')),P=v.length-1,I=0,K=v.length;I<K;++I)F=I,V=v[I],D(V,N,d,o,a,l,!F,F===P,null!=(A=v[F+1])?A[2]:void 0)},D(t,void 0,-1,"",!1,"",!0,!0),b=0,v=(s=Object.keys(s)).length;b<v;++b){for(A=b,_=[],G=(j=s[b]).length/2,H=0,M=(w=o).length;H<M&&G>(W=w[H])[1];++H)q=j.substring(2*W[1],2*W[2]).replace(/\  /g,"\t").replace(/\ /g,"\t"),_.push(q);s[A]=_}u.taxon.count=n.length,u.speciesSubspExists.count=u.speciesSubsp.count-u.speciesSubspExtinct.count,h&&(n=n.filter((e=>e.lv<=h)))},await f(),b=(new Date).setHours(0,0,0,0);try{w=JSON.parse(localStorage.taxonModfCounts)}catch(e){for(v in e,w={},u)g=u[v],w[v]=g.count}if(b===+localStorage.taxonModfTime)for(v in u)(g=u[v]).modfCount=g.count-w[v];else{for(v in u)g=u[v],w[v]=g.count,g.modfCount=0;localStorage.taxonModfTime=b,localStorage.taxonModfCounts=JSON.stringify(w)}x={oninit:function(){var e,t;for(e in this)"function"==typeof(t=this[e])&&(this[e]=t.bind(this));this.lines=[],this.start=void 0,this.len=0,this.finding=!1,this.findVal="",this.findLines=[],this.findIndex=0,this.findExact=!!localStorage.taxonFindExact,this.findCase=!!localStorage.taxonFindCase,this.findTimo=void 0,this.code=void 0,this.isKeyDown=!0,this.hoveredLine=void 0,this.popper=void 0,this.abortCtrler=void 0,this.rightClickAction=localStorage.taxonRightClickAction,this.popupLang=localStorage.taxonPopupLang},oncreate:function(){heightEl.style.height=n.length*i+"px",addEventListener("keydown",this.onkeydown),addEventListener("keyup",this.onkeyup),addEventListener("mousedown",this.onmousedown),addEventListener("blur",this.onblur),addEventListener("resize",this.onresize),scrollEl.scrollTop=+localStorage.taxonTop||0,this.onresize()},class:function(...e){var t,i,n,s,o,a;for(t=[],i=0,n=e.length;i<n;++i)if(s=e[i],Array.isArray(s))t.push((o=this.class).apply.apply(o,s));else if(s instanceof Object)for(a in s)s[a]&&t.push(a);else null!=s&&t.push(s);return t.join(" ")},getRankName:function(e){return o.find((t=>t[2]>e))[0]},getRankTexts:function(e,t,i){var n;return n=a[e][Number("vi"===t)],Array.isArray(n)?n[+i]:n},find:function(e){null!=e?this.findVal=e:e=this.findVal,this.finding||(this.finding=!0,m.redraw.sync(),findInputEl.select()),findInputEl.focus(),this.findTimo&&clearTimeout(this.findTimo),this.findTimo=setTimeout((()=>{this.findTimo=void 0,(e=e.trim()).length>1?(this.findCase||(e=e.toLowerCase()),this.findLines=n.filter((t=>{var i,n,s;return i=null!=(n=t.textVi)?n:"",s=this.getFullNameNoSubgenus(t),Number.isFinite(i)&&(i=""),this.findCase||(s=s.toLowerCase(),i=i.toLowerCase()),this.findExact?e===s||e===i:s.includes(e)||i.includes(e)})),this.findIndex>=this.findLines.length&&(this.findIndex=this.findLines.length-1)):this.findLines=[],this.findLines.length&&this.findGo(),m.redraw()}),100),m.redraw()},findGo:function(e){var t;null==e&&(e=0),this.findLines.length&&(this.findIndex=((this.findIndex+e)%(t=this.findLines.length)+t)%t,scrollEl.scrollTop=(this.findLines[this.findIndex].index-4)*i,this.scroll())},toggleFindExact:function(){this.findExact=!this.findExact,localStorage.taxonFindExact=this.findExact?"1":"",this.find()},toggleFindCase:function(){this.findCase=!this.findCase,localStorage.taxonFindCase=this.findCase?"1":"",this.find()},togglePopupLang:function(){this.popupLang="vi"===this.popupLang?"en":"vi",localStorage.taxonPopupLang=this.popupLang},closeFind:function(){this.finding&&(this.finding=!1,this.findLines=[],this.fetchTextEnCopyLines(),m.redraw())},mousedownImg:function(e,t){var i,n,s,o,a;if(i=t.target,n=e[0],1===t.which){switch(!1){case!n.includes("upload.wikimedia.org"):s=10*Math.round(i.naturalWidth/i.naturalHeight*80),n=n.replace(/\/320px-/,"/"+s+"px-");break;case!n.includes("static.inaturalist.org"):case!n.includes("inaturalist-open-data.s3.amazonaws.com"):n=n.replace("/medium.","/large.");break;case!n.includes("live.staticflickr.com"):n=n.replace("_e.","_b.");break;case!n.includes("cdn.download.ams.birds.cornell.edu"):n=n.replace(/\d+$/,"1800");break;case!n.includes("images.marinespecies.org"):n=n.replace("?w=320","?w=1200");break;case!n.includes("i.pinimg.com"):n=n.replace("564x","originals");break;case!n.includes("i.imgur.com"):"Delete"===this.code?(n="".replace.call(n,/(?<=:\/\/)i\.|m\.\w+$/g,""),n+="?_taxonDelete=1"):n=n.replace(/m(?=\.\w+$)/,"r");break;case!n.includes("cdn.jsdelivr.net/gh/tientq64/taimg"):o=(a=n.split("/"))[a.length-1],n="https://github.com/tientq64/taimg/"+("Delete"===this.code?"delete":"blob")+"/main/"+o}window.open(n,"_blank")}},mousedownName:function(e,t){var i,n,s,o,a;if(""!==(i=e.name)&&"?"!==i)switch(t.which){case 1:l?(n=t.altKey?"vi":"en",s=this.getWikiPageName(e,n),window.open("https://"+n+".wikipedia.org/wiki/"+s,"_blank")):(s=this.getWikiPageName(e,"vi"),window.open("https://vi.wikipedia.org/wiki/"+s,"_blank"));break;case 2:t.preventDefault(),o=this.getFullNameNoSubgenus(e),t.altKey?a=l?o:e.name:l?window.open("https://google.com/search?q="+o+"+common+name","_blank"):a=o;try{navigator.clipboard.writeText(a)}catch(e){alert(e.message)}}},contextmenuName:async function(e,t){var i,n,s,o,a,r;if(t.preventDefault(),l){if(""!==(i=e.name)&&"?"!==i)switch(n=this.getFullNameNoSubgenus(e),await async function(){switch(!1){case!t.altKey:return"g";case"KeyC"!==this.code:return"c";case"KeyB"!==this.code:return"b";case"KeyL"!==this.code:return"l";case"KeyH"!==this.code:return"h";case"KeyE"!==this.code:return"e";case"KeyS"!==this.code:return"s";case"KeyN"!==this.code:return"n";case"KeyK"!==this.code:return"k";default:return this.rightClickAction}}.call(this)){case"g":window.open("https://google.com/search?tbm=isch&q="+n,"_blank");break;case"c":window.open("https://google.com/search?q="+n+"+common+name","_blank");break;case"b":window.open("https://bugguide.net/index.php?q=search&keys="+n);break;case"l":window.open("https://www.biolib.cz/en/formsearch/?string="+n+"&searchgallery=1&action=execute");break;case"h":s=(i=n.split(" "))[0],(o=i[1])?window.open("https://fishbase.us/photos/ThumbnailsSummary.php?Genus="+s+"&Species="+o,"_blank"):window.open("http://fishbase.us/Nomenclature/ValidNameList.php?syng="+s+"&crit2=CONTAINS&crit1=EQUAL");break;case"e":a=async e=>{var t,i;if(i=(t=await(await fetch("https://api.ebird.org/v2/ref/taxon/find?key=jfekjedvescr&q="+e)).json()).find((t=>t.name.includes(e)))||t[0])return window.open("https://ebird.org/species/"+i.code),!0},await a(n)||e.textEn&&await a(e.textEn);break;case"s":n=n.toLowerCase().replace(/\ /g,"-"),window.open("https://www.seriouslyfish.com/species/"+n);break;case"n":window.open("https://inaturalist.org/taxa/search?view=list&q="+n);break;case"k":window.open("https://www.flickr.com/search/?text="+n)}}else r=this.getWikiPageName(e,"en"),window.open("https://en.wikipedia.org/wiki/"+r,"_blank")},mouseenterName:async function(e,t){var i,n,s,o,a,l,r,c,h;"?"!==(i=e.name)&&" "!==i&&(this.hoveredLine=e,(n=e.imgs)&&(n=n.slice(0,2)),328,s=Boolean(n&&n[0]&&n[1]),o=this.getFullNameNoSubgenus(e),a=this.getIcon(e),l="",r=()=>{var e;popupEl.offsetHeight>innerHeight-4&&(e=l.split(" ")).length>2?(l=e.slice(0,-1).join(" ").concat("..."),summaryEl.innerHTML=l,r()):this.popper.update()},c=e=>{var t;if(null==e&&(e=0),!s&&(224,nameEl.offsetWidth>224))switch((t=o.split(" ")).length){case 4:switch(e){case 0:o=t[0]+" "+t[1][0]+". "+t[2]+" "+t[3],nameEl.textContent=o,c(1);break;case 1:o=t[0][0]+". "+t[1]+" "+t[2]+" "+t[3],nameEl.textContent=o}break;case 3:switch(e){case 0:o=t[0]+" "+t[1][0]+". "+t[2],nameEl.textContent=o,c(1);break;case 1:o=t[0][0]+". "+t[1]+" "+t[2],nameEl.textContent=o}break;case 2:o=t[0][0]+". "+t[1],nameEl.textContent=o}},h={view:t=>m(".popupBody",{class:this.class({popupIsTrinomial:e.lv>39,popupIsTwoImage:s}),style:{minWidth:"328px"}},m(".popupName",a?m("img.popupIcon",{src:"https://img.icons8.com/plumpy/1x/"+a+".png"}):void 0,m("#nameEl",o),m(".popupRank",this.getRankTexts(e.lv,this.popupLang,!0))),e.textEn?m(".popupTextEn",e.textEn):void 0,e.textVi&&isNaN(e.textVi)?m(".popupTextVi",e.textVi):void 0,n?m(".popupGenders",{class:this.class({popupGendersTwoImg:s})},n.map(((e,t)=>{if(e)return m(".popupGender",m(".popupPicture",m("img.popupBgImg",{src:e[0]}),m("img.popupImg",{src:e[0],onload:e=>{var t,i,n,o;i=(t=e.target).width,n=t.height,(i<320&&n<240||!s&&1.233<(o=i/n)&&o<1.333)&&t.classList.add("popupImg--cover"),this.popper&&r()},onerror:()=>{this.popper&&this.popper.update()}})),2===n.length||n.some((function(e){return null!=e?e[1]:void 0}))?m(".popupGenderCaptn",2===n.length?t?"Cái":"Đực":void 0,e[1]?2===n.length?" – "+e[1]:e[1]:void 0):void 0)}))):void 0,m(".popupSummary#summaryEl",{translate:!0}))},m.mount(popupEl,h),this.popper?this.popper.update():this.popper=Popper.createPopper(t.target,popupEl,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,21]}},{name:"preventOverflow",options:{padding:2}}]}),c(),l=(await this.fetchWiki(e)).summary,this.popper&&(l=l?l.replace(/<br \/>/g,"").replace(/(?<!\.)\.\.(?!\.)/g,"."):"Không có dữ liệu",summaryEl.innerHTML=l,r()))},mouseleaveName:function(){this.hoveredLine&&(this.hoveredLine=void 0,this.abortCtrler&&(this.abortCtrler.abort(),this.abortCtrler=void 0),this.popper.destroy(),this.popper=void 0,m.mount(popupEl))},onclickTextEnCopy:async function(e,t,i){var n,s;e.textEnCopy=t,n=e.index;try{(s=await navigator.clipboard.readText())&&(s+="\n"),s+=n+"|DA84.&D-+7eDL2qr|",s+=await async function(){switch(!1){case!e.textVi:return" "+t;case!e.imgs:return" "+t+" #";default:return" # "+t}}(),await navigator.clipboard.writeText(s)}catch(e){alert(e.message)}},getFullNameNoSubgenus:function(e){return(e.fullName||e.name).replace(/\ \(.+?\)/,"")},getIcon:function(e){if(e)return e.icon?e.icon:this.getIcon(e.parent)},getWikiPageName:function(e,t){var i,n,s,o;switch((i=e.disam)&&(n=i[Number("vi"===t)])&&(s=n[0],n=n.substring(1)),o=(o=this.getFullNameNoSubgenus(e)).replace(/\ /g,"_"),s){case"/":return n||"_";case"\\":return o+"_("+n+")";default:return o}},fetchWiki:async function(e,t){var i,n,s,o,a,r,c,h,p,u,d,m,g,f,b,w,v,x,y;try{if(i=t?"en":this.popupLang,n=this.getWikiPageName(e,i),s={},t||(null!=(o=this.abortCtrler)&&o.abort(),this.abortCtrler=new AbortController,s.signal=this.abortCtrler.signal),a=await(await fetch("https://"+i+".wikipedia.org/api/rest_v1/page/summary/"+n,s)).json(),t||(this.abortCtrler=void 0),r=a.extract_html,"standard"===a.type){for(c=a.title.replace(/\ \(.+?\)/,""),p=[h=e.fullName||e.name],(u=this.getFullNameNoSubgenus(e))!==h&&p.push(u),d=e;d=d.parent;)p.push(this.getFullNameNoSubgenus(d));for(m=[c],(g=r.match(/<b>.+?<\/b>/g))&&m.push.apply(m,g),f=0,b=m.length;f<b;++f)c=m[f],(w=/<(\w+)[^>]*>(.+?)<\/\1>/.exec(c))&&(c=w[2]),!(c=c.replace(/,/g,"").trim())||p.includes(c)||c.includes(". ")||(c=c[0].toUpperCase()+c.substring(1),null==v&&(v=[]),v.includes(c)||v.push(c))}if("standard"!==a.type&&!l||!r)throw null;x=/<p>(.+?)<\/p>/su.exec(r)[0].replace(/\n+/g," ").replace(/^<p><b>(.+?)<\/b><\/p>$/u,"<p>$1</p>")}catch(e){e,x=""}if(y={summary:x,titles:v},!t)return y;t(e,y)},fetchTextEnCopyLines:function(){var e,t,i,n,s=(e,t)=>{var i;(i=(null!=t?t:{}).titles)&&(i=i.map((e=>e.replace(/’/g,"'")))),e.textEnCopy=i||!1,m.redraw()};for(e=0,i=(t=this.lines).length;e<i;++e)(n=t[e]).lv>=0&&1!==n.childsCount&&void 0===n.textEn&&void 0===n.textEnCopy&&(n.textEnCopy="...",this.fetchWiki(n,s))},scroll:function(){var e,t,s;t=(e=Math.round(scrollEl.scrollTop))-e%i,presEl.style.transform="translateY("+t+"px)",localStorage.taxonTop=e,(s=Math.floor(e/i))===this.start&&this.lines.length===this.len||(this.start=s,this.lines=n.slice(s,s+this.len),l&&(this.finding||this.fetchTextEnCopyLines()),m.redraw()),this.mouseleaveName()},onscroll:function(e){e.redraw=!1,this.scroll()},onkeydown:function(e){var t;if(!e.repeat&&1!==(t=e.location)&&2!==t&&(document.activeElement===document.body,this.isKeyDown=!0,this.code=e.code,"KeyF"===this.code))e.ctrlKey&&e.preventDefault()},onkeyup:async function(e){var t,s,o,a,r,c,u,d;if(this.isKeyDown){switch(t=document.activeElement===document.body,s=e.ctrlKey,e.shiftKey,o=e.altKey,this.code){case"KeyF":t&&this.find();break;case"KeyX":this.finding&&o&&this.toggleFindExact();break;case"KeyC":this.finding&&o&&this.toggleFindCase();break;case"KeyI":t&&(a=e.shiftKey?2:1,p=p&&p===a?0:a,localStorage.taxonInfoLv=p,m.redraw());break;case"KeyA":t&&(s||l&&(r=prompt("Nhập hành động khi bấm chuột phải:\ng) google\nc) google (common name)\nb) bugguide\nl) biolib\nh) fishbase\ne) ebird\ns) seriouslyfish\nn) inaturalist\nk) flickr (mặc định)",this.rightClickAction))&&(this.rightClickAction=r,localStorage.taxonRightClickAction=r));break;case"KeyT":t&&(s||l&&(c=+prompt("Rank tối đa được hiển thị:\n1) vực                  2) giới               3) phân giới         4) thứ giới\n5) liên ngành       6) ngành          7) phân ngành     8) thứ ngành\n9) tiểu ngành      10) liên lớp       11) lớp                 12) phân lớp\n13) thứ lớp          14) tiểu lớp      15) đoàn              16) liên đội\n17) đội                18) tổng bộ      19) liên bộ            20) bộ\n21) phân bộ         22) thứ bộ       23) tiểu bộ           24) đoạn\n25) phân đoạn     26) liên họ       27) họ                  28) phân họ\n29) liên tông        30) tông          31) phân tông      32) chi\n33) phân chi        34) mục           35) phân mục       36) loạt\n37) phân loạt       38) liên loài     39) loài                 40) phân loài\n41) thứ                 42) dạng"))&&(h=c,this.lines=[],u=scrollEl.scrollTop,await f(),heightEl.style.height=n.length*i+"px",this.scroll(),m.redraw.sync(),u>(d=n.length*i-scrollEl.offsetHeight)&&(u=d),scrollEl.scrollTop=u));break;case"KeyV":t&&(s||(this.togglePopupLang(),this.hoveredLine&&this.mouseenterName(this.hoveredLine)));break;case"KeyE":if(l)try{await navigator.clipboard.writeText("")}catch(e){alert(e.message)}break;case"Digit1":t&&(s||l&&window.open("diff"));break;case"Escape":this.finding&&this.closeFind()}this.code=void 0,this.isKeyDown=!1,m.redraw()}},onmousedown:function(e){this.isKeyDown=!1},onblur:function(e){this.code=void 0,this.isKeyDown=!1},onresize:function(){this.len=Math.ceil(innerHeight/i)+1,this.scroll(),m.redraw()},view:function(){var e;return m.fragment(m("#scrollEl",{onscroll:this.onscroll},m("#presEl",this.lines.map((e=>{var t;return m(".line",{key:e.index,class:this.class({lineFind:this.finding&&e===this.findLines[this.findIndex]})},s[e.chrs].reduce(((e,t,i)=>{var n;return!(n=e.at(-1))||t.trim()&&n.children[0].children.trim()?e.push(m("span",{class:o[i][0]},t)):e.at(-1).children[0].children+=t,e}),[]),m(".node",m("span.name",{class:this.getRankName(e.lv),onmouseenter:this.mouseenterName.bind(void 0,e),onmouseleave:this.mouseleaveName,onmousedown:this.mousedownName.bind(void 0,e),oncontextmenu:this.contextmenuName.bind(void 0,e)},e.name),e.textEn||e.textVi||e.textEnCopy&&"..."!==e.textEnCopy?m("span.dash","—"):void 0,e.textEn?m("span.textEn",e.textEn):void 0,e.textEnCopy?Array.isArray(e.textEnCopy)?m(".textEn",e.textEnCopy.map((t=>m(".textEnCopy",{class:e.isDuplicateTextEn?"textEnCopyIsDuplicateTextEn":void 0,onclick:this.onclickTextEnCopy.bind(void 0,e,t)},t)))):m("span.textEn",e.textEnCopy):void 0,e.textVi?m("span.textVi",e.textVi):void 0,e.isShowChildsCount?m("span.textVi","("+e.childsCount+")"):void 0,null!=(t=e.imgs)?t.map(((e,t)=>{if(e&&t<2)return m("img.img",{src:e[0],onmousedown:this.mousedownImg.bind(void 0,e)})})):void 0))}))),m("#heightEl")),p?m("#infosEl",function(){var t,i,n=[];for(t in i=u)e=i[t],p>=e.lv&&n.push(m.fragment(m(".info",e.label),m(".info",c.format(e.count)),m(".info",e.modfCount?m(".modfCount",{class:e.modfCount>0?"modfCountIncr":"modfCountDecr"},"("+(e.modfCount>0?"+":"")+c.format(e.modfCount)+")"):void 0)));return n}(),m(".info","Ngôn ngữ popup"),m(".info",this.popupLang)):m(".lang",{class:"vi"===this.popupLang?"langIsVi":void 0,title:"Ngôn ngữ trong phần mô tả",onclick:()=>{this.togglePopupLang()}},this.popupLang),this.finding?m("#findEl",m("input#findInputEl",{placeholder:"Tìm kiếm",autocomplete:"off",value:this.findVal,oninput:e=>{this.find(e.target.value)},onkeydown:e=>{"Enter"===e.key&&this.findGo(e.shiftKey?-1:1)}}),m("#findTextEl",(this.findLines.length&&this.findIndex+1||0)+"/"+this.findLines.length),m(".findButton",{class:this.findExact?"findButtonOn":void 0,title:"Tìm chính xác",onclick:this.toggleFindExact},'""'),m(".findButton",{class:this.findCase?"findButtonOn":void 0,title:"Phân biệt hoa-thường",onclick:this.toggleFindCase},"Aa"),m(".findButton#findClose",{title:"Đóng",onclick:this.closeFind},"⨉")):void 0,m("#popupEl"))}},m.mount(document.body,x)}()</script>